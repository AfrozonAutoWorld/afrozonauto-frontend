"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[850],{6116:function(e,t,r){r.d(t,{U:function(){return u}});var n=r(7437),a=r(7648),s=r(8997),i=r(3774),o=r(1047),c=r(6858),l=r(8135);function u(e){var t,r,u,d,h,f,g;let{vehicle:m,onSave:p,isSaved:v}=e,y=(null===(d=(t=m).apiData)||void 0===d?void 0:null===(u=d.listing)||void 0===u?void 0:null===(r=u.retailListing)||void 0===r?void 0:r.primaryImage)||(null===(g=t.apiData)||void 0===g?void 0:null===(f=g.listing)||void 0===f?void 0:null===(h=f.wholesaleListing)||void 0===h?void 0:h.primaryImage)||(t.images&&t.images.length>0?t.images[0]:"https://images.pexels.com/photos/170811/pexels-photo-170811.jpeg?auto=compress&cs=tinysrgb&w=800");return(0,n.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-lg transition-all duration-300 group",children:[(0,n.jsxs)("div",{className:"relative aspect-[16/10] overflow-hidden bg-gray-100",children:[(0,n.jsx)("img",{src:y,alt:"".concat(m.year," ").concat(m.make," ").concat(m.model),className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500",onError:e=>{e.currentTarget.src="https://images.pexels.com/photos/170811/pexels-photo-170811.jpeg?auto=compress&cs=tinysrgb&w=800"}}),(0,n.jsx)("div",{className:"absolute top-3 left-3",children:(0,n.jsx)("span",{className:"bg-emerald-600 text-white text-xs font-semibold px-2 py-1 rounded",children:m.vehicleType})}),p&&(0,n.jsx)("button",{onClick:e=>{e.preventDefault(),p(m.id)},className:"absolute top-3 right-3 p-2 rounded-full transition-colors ".concat(v?"bg-red-500 text-white":"bg-white/90 text-gray-600 hover:bg-red-500 hover:text-white"),children:(0,n.jsx)(s.Z,{className:"w-5 h-5 ".concat(v?"fill-current":"")})})]}),(0,n.jsxs)("div",{className:"p-4",children:[(0,n.jsxs)("div",{className:"mb-3",children:[(0,n.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 text-start",children:[m.year," ",m.make," ",m.model]}),(0,n.jsxs)("div",{className:"flex items-center gap-1 text-sm text-gray-500 mt-1",children:[(0,n.jsx)(i.Z,{className:"w-4 h-4"}),(0,n.jsxs)("span",{children:[m.dealerCity,", ",m.dealerState]})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)(o.Z,{className:"w-4 h-4"}),(0,n.jsx)("span",{children:m.year})]}),(0,n.jsx)("span",{className:"text-gray-400",children:"|"}),(0,n.jsx)("span",{children:m.transmission})]}),(0,n.jsxs)("div",{className:"border-t border-gray-100 pt-4",children:[(0,n.jsx)("div",{className:"flex justify-between items-start mb-3",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-xs text-gray-500",children:"US Price"}),(0,n.jsx)("p",{className:"text-lg font-bold text-gray-900",children:(0,l.xG)(m.priceUsd)})]})}),(0,n.jsxs)(a.default,{href:"/vehicles/".concat(m.id),className:"flex items-center justify-center gap-2 w-full bg-gray-900 text-white py-2.5 rounded-lg font-medium hover:bg-emerald-600 transition-colors",children:["View Details",(0,n.jsx)(c.Z,{className:"w-4 h-4"})]})]})]})]})}},1e3:function(e,t,r){r.d(t,{$v:function(){return s},PT:function(){return i}});var n=r(1713),a=r(7321);function s(e){var t,r,s;let i=(0,n.a)({queryKey:["vehicles",e],queryFn:()=>a.r.getAll(e),staleTime:3e5,refetchOnWindowFocus:!1});return{vehicles:null!==(s=null===(t=i.data)||void 0===t?void 0:t.vehicles)&&void 0!==s?s:[],meta:null===(r=i.data)||void 0===r?void 0:r.meta,isLoading:i.isLoading,isError:i.isError,error:i.error,refetch:i.refetch,isFetching:i.isFetching}}function i(e){let t=(0,n.a)({queryKey:["vehicle",e],queryFn:()=>a.r.getById(e),enabled:!!e,staleTime:6e5});return{vehicle:t.data,isLoading:t.isLoading,isError:t.isError,error:t.error,refetch:t.refetch}}},6305:function(e,t,r){r.d(t,{M:function(){return i},x:function(){return c}});var n=r(3464),a=r(4191);let s=r(257).env.NEXT_PUBLIC_API_BASE_URL;class i extends Error{constructor(e,t,r,n,a,s){super(e),this.status=t,this.code=r,this.errors=n,this.details=a,this.data=s,this.name="ApiError"}}class o{setupInterceptors(){this.client.interceptors.request.use(async e=>{var t;let{accessToken:r,isAuthenticated:i,refreshToken:o}=a.tN.getState();if(null===(t=e.url)||void 0===t?void 0:t.includes("/auth/refresh-token"))return e;if(i&&r){if((0,a.Rm)(r,60)&&o&&!this.isRefreshing)try{this.isRefreshing=!0;let{accessToken:t,refreshToken:r}=(await n.Z.post("".concat(s,"/auth/refresh-token"),{token:o},{headers:{"Content-Type":"application/json"},timeout:1e4})).data.data;a.tN.getState().setAuth(a.tN.getState().user,t,r),e.headers.Authorization="Bearer ".concat(t)}catch(t){console.error("❌ API Interceptor: Proactive token refresh failed:",t),e.headers.Authorization="Bearer ".concat(r)}finally{this.isRefreshing=!1}else e.headers.Authorization="Bearer ".concat(r)}return e},e=>Promise.reject(e)),this.client.interceptors.response.use(e=>e,async e=>{var t;let r=e.config;if((null===(t=e.response)||void 0===t?void 0:t.status)===401&&!r._retry){if(this.isRefreshing)return new Promise((e,t)=>{this.failedQueue.push({resolve:e,reject:t})}).then(()=>{let{accessToken:e}=a.tN.getState();return r.headers&&e&&(r.headers.Authorization="Bearer ".concat(e)),this.client(r)}).catch(e=>Promise.reject(e));r._retry=!0,this.isRefreshing=!0;try{let{refreshToken:e}=a.tN.getState();if(!e)throw console.warn("⚠️ API Interceptor: No refresh token available for 401 retry"),Error("No refresh token available");let{accessToken:t,refreshToken:i}=(await n.Z.post("".concat(s,"/auth/refresh-token"),{token:e},{headers:{"Content-Type":"application/json"},timeout:1e4})).data.data;return a.tN.getState().setAuth(a.tN.getState().user,t,i),this.processQueue(null),r.headers&&(r.headers.Authorization="Bearer ".concat(t)),this.client(r)}catch(e){return console.error("❌ API Interceptor: Token refresh failed after 401:",e),this.processQueue(e),this.handleLogout(),Promise.reject(this.transformError(e))}finally{this.isRefreshing=!1}}return Promise.reject(this.transformError(e))})}transformError(e){if(e.response){let{data:t,status:r}=e.response;return new i((null==t?void 0:t.message)||"Request failed with status ".concat(r),r,null==t?void 0:t.code,null==t?void 0:t.errors,null==t?void 0:t.details,t)}return"ECONNABORTED"===e.code?new i("Request timeout",0):new i(e.message||"Network error",0)}processQueue(e){this.failedQueue.forEach(t=>{e?t.reject(e):t.resolve()}),this.failedQueue=[]}handleLogout(){let{clearAuth:e}=a.tN.getState();e();{let e=window.location.pathname;["/dashboard","/request-details"].some(t=>e.startsWith(t))&&(window.location.href="/login")}}async get(e,t){return(await this.client.get(e,t)).data}async post(e,t,r){return(await this.client.post(e,t,r)).data}async put(e,t,r){return(await this.client.put(e,t,r)).data}async patch(e,t,r){return(await this.client.patch(e,t,r)).data}async delete(e,t){return(await this.client.delete(e,t)).data}constructor(e){this.isRefreshing=!1,this.failedQueue=[],this.client=n.Z.create({baseURL:e,headers:{"Content-Type":"application/json"},timeout:15e3}),this.setupInterceptors()}}let c=new o(s)},7321:function(e,t,r){r.d(t,{r:function(){return i}});var n=r(6305);let a=e=>{if(!e)return"";let t=new URLSearchParams;Object.entries(e).forEach(e=>{let[r,n]=e;null!=n&&""!==n&&t.append(r,String(n))});let r=t.toString();return r?"?".concat(r):""},s=e=>({vehicles:e.data.data,meta:e.data.meta}),i={getAll:async e=>{try{let t=a(e),r=await n.x.get("/vehicles".concat(t));return s(r)}catch(e){throw console.error("Error fetching vehicles:",e),Error("Failed to fetch vehicles")}},getById:async e=>{try{var t,r;let a=(await n.x.get("/vehicles/".concat(e))).data.data;return{...a,images:null!==(t=a.images)&&void 0!==t?t:[],features:null!==(r=a.features)&&void 0!==r?r:[]}}catch(t){throw console.error("Error fetching vehicle ".concat(e,":"),t),Error("Failed to fetch vehicle with ID: ".concat(e))}},saveVehicle:async e=>{try{return(await n.x.post("/vehicles/save-from-api",e)).data}catch(e){throw console.error("Error saving vehicle:",e),Error("Failed to save vehicle")}},getModels:async e=>{try{if(!e)throw Error("Make parameter is required");return(await n.x.get("/vehicles/makes/".concat(encodeURIComponent(e),"/models"))).data}catch(t){throw console.error("Error fetching models for ".concat(e,":"),t),Error("Failed to fetch models for make: ".concat(e))}},getAvailable:async e=>i.getAll({...e,status:"AVAILABLE"}),search:async(e,t)=>i.getAll({...t,search:e})}},4191:function(e,t,r){r.d(t,{Rm:function(){return i},mc:function(){return s},tN:function(){return c}});var n=r(3011),a=r(6885);function s(e){if(!e)return!0;try{let t=e.split(".");if(3!==t.length)return!0;let r=JSON.parse(atob(t[1]));if(!r.exp)return!1;let n=Math.floor(Date.now()/1e3);return r.exp<n}catch(e){return console.error("Error decoding token:",e),!0}}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60;if(!e)return!0;try{let r=e.split(".");if(3!==r.length)return!0;let n=JSON.parse(atob(r[1]));if(!n.exp)return!1;let a=Math.floor(Date.now()/1e3);return n.exp<a+t}catch(e){return console.error("Error decoding token:",e),!0}}let o={getItem:e=>{let t=localStorage.getItem(e);return t?JSON.parse(t):null},setItem:(e,t)=>{localStorage.setItem(e,JSON.stringify(t))},removeItem:e=>{localStorage.removeItem(e)}},c=(0,n.U)()((0,a.tJ)((e,t)=>({user:null,accessToken:null,refreshToken:null,isAuthenticated:!1,isHydrated:!1,isInitialized:!1,setAuth:(t,r,n)=>{e({user:t,accessToken:r,refreshToken:n||null,isAuthenticated:!0,isHydrated:!0,isInitialized:!0})},updateUser:t=>e(e=>({...e,user:t})),setAccessToken:t=>e({accessToken:t}),clearAuth:()=>{e({user:null,accessToken:null,refreshToken:null,isAuthenticated:!1,isHydrated:!0,isInitialized:!0})},setHydrated:t=>e({isHydrated:t}),setInitialized:t=>e({isInitialized:t}),isTokenExpired:()=>{let{accessToken:e}=t();return s(e)}}),{name:"auth-storage",storage:(0,a.FL)(()=>o),partialize:e=>({user:e.user,accessToken:e.accessToken,refreshToken:e.refreshToken,isAuthenticated:e.isAuthenticated}),onRehydrateStorage:()=>e=>{if(e&&(e.isHydrated=!0,e.isAuthenticated&&e.accessToken)){let t=s(e.accessToken),r=!!e.refreshToken;t&&!r&&(console.warn("Token expired and no refresh token available, clearing auth"),e.user=null,e.accessToken=null,e.refreshToken=null,e.isAuthenticated=!1)}}}))},8135:function(e,t,r){r.d(t,{LI:function(){return l},X:function(){return o},p6:function(){return c},qA:function(){return s},xG:function(){return i},yG:function(){return u}});let n={sourcing_fee_percent:5,sourcing_fee_min_usd:500,inspection_fee_usd:150,us_handling_fee_usd:350,shipping_roro_base_usd:1800,shipping_container_base_usd:2500,exchange_rate_ngn_usd:1550,timeline_days_roro:45,timeline_days_container:60},a={CAR:1,SEDAN:1,COUPE:1,HATCHBACK:1,WAGON:1.05,CONVERTIBLE:1.05,SUV:1.15,TRUCK:1.25,VAN:1.2,MOTORCYCLE:0};function s(e,t,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n,i=a[t]||1,o=Math.max(s.sourcing_fee_percent/100*e,s.sourcing_fee_min_usd),c=s.inspection_fee_usd,l=s.us_handling_fee_usd,u=("RORO"===r?s.shipping_roro_base_usd:s.shipping_container_base_usd)*i,d=e+o+c+l+u,h=d*s.exchange_rate_ngn_usd;return{breakdown:{vehicle_price:e,sourcing_fee:o,inspection_fee:c,us_handling_fee:l,shipping_cost:u,total_usd:d,total_ngn:h,exchange_rate:s.exchange_rate_ngn_usd},estimatedDeliveryDays:"RORO"===r?s.timeline_days_roro:s.timeline_days_container,depositAmount:.3*d}}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD";return"NGN"===t?new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN",minimumFractionDigits:0,maximumFractionDigits:0}).format(e):new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}function o(e){let t=new Date;return t.setDate(t.getDate()+e),t}function c(e){return("string"==typeof e?new Date(e):e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}let l=["Lagos","Abuja","Port Harcourt","Kano","Ibadan","Enugu","Kaduna","Benin City","Warri","Calabar","Aba","Jos","Ilorin","Onitsha","Abeokuta","Uyo","Owerri","Akure","Bauchi","Sokoto"],u=["Toyota","Honda","Ford","Chevrolet","BMW","Mercedes-Benz","Lexus","Nissan","Hyundai","Kia","Mazda","Volkswagen","Audi","Subaru","Jeep","Dodge","Ram","GMC","Acura","Infiniti","Cadillac","Lincoln","Volvo","Land Rover","Porsche"]}}]);